<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<link rel="stylesheet" href="app.css">
<link rel="stylesheet" href="animate.css">
<link rel="stylesheet" href="bootstrap.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script>
<script src="echarts.min.js"></script>

<!--<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts.min.js"></script>-->
<!--<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-gl/echarts-gl.min.js"></script>-->
<!--<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-stat/ecStat.min.js"></script>-->
<!--<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/dataTool.min.js"></script>-->
<!--<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/china.js"></script>-->
<!--<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/world.js"></script>-->
<!--<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM"></script>-->
<!--<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/bmap.min.js"></script>-->
<!--<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/simplex.js"></script>-->
<body>
<div id="app" @mousemove="updateXY">

    <div id="header">
        <div id="header_content" @click="menu_click">

        </div>
        <!--<div id="header_bar">-->
            <!--<ul>-->
                <!--<li><router-link to="/main">Main</router-link></li>-->
                <!--<li><router-link to="/demo1">Demo1</router-link></li>-->
                <!--<li><router-link to="/demo2">Demo2</router-link></li>-->
                <!--<li><router-link to="/demo3">Demo3</router-link></li>-->
            <!--</ul>-->
        <!--</div>-->
    </div>

    <div class="content" @click="hide_menu">
        <router-view></router-view>
    </div>
    <transition enter-active-class="animated slideInLeft" leave-active-class="animated slideOutLeft">
        <!--<div id="nav_bar" v-show="mouse_X < 100 || menu_show">-->
        <div id="nav_bar" v-show=" menu_show">
            <ul>
                <li><router-link to="/main">Main</router-link></li>
                <li><router-link to="/demo1">Demo1</router-link></li>
                <li><router-link to="/demo2">Demo2</router-link></li>
                <li><router-link to="/demo3">Demo3</router-link></li>
            </ul>
        </div>
    </transition>

    <div>{{mouse_X}}, {{mouse_Y}}</div>
    <button @click="testb()">TEST</button>
    <!--<div id="picture" style="width: 600px;height: 400px"></div>-->

    <br>
    <hr>
    <hr>
    <!--<canvas id="can_demo2"></canvas>-->
    <!--<canvas id="can_demo2"></canvas>-->
</div>

<script src="vue.js"></script>
<script src="vue-router.js"></script>
<script src="vue-resource.js"></script>
<script src="jquery-3.2.1.js"></script>
<script>
    $.ajaxSetup({
        async: false
    });
    var main = {
        template:`
<div id="main">
    <ul>
    <li>
        <router-link to="/demo1"><div class="items">
            <img class="item_img" src="https://www.excel-easy.com/smi/examples/line-chart.png" alt="">
        </div></router-link></li>
    <li>
        <router-link to="/demo2"><div class="items">
            <img class="item_img" src="https://canvasjs.com/wp-content/uploads/images/gallery/javascript-charts/column/javascript-column-charts-graphs.png" alt="">
        </div></router-link>
    </li>
    <li>
        <router-link to="/demo3"><div class="items">
            <img class="item_img" src="https://docs.microsoft.com/en-us/sql/reporting-services/report-builder/media/report-builder-quick-pie-chart.png?view=sql-server-2017" alt="">

        </div></router-link>
    </li>
    <li><div class="items"></div></li>
    <li><div class="items"></div></li>
    <li><div class="items"></div></li>
    </ul>
</div>
`
    };

    var demo1 = {
        data:function () {
            return {
                str:"",
                map_color:['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026'],
                map_value:[{name: 'Alabama', value: 50},
                    // {name: 'Alaska', value: 731449},
                    {name: 'Arizona', value: 4}],
                locations:{'aa':[145.52,-24.35],
                    'bb':[150,-33.65],
                    'cc':[136.37,-31.13],
                    'Sydney':[136.37,-31.13],
                    'dd':[150.65,-28.01]},
                data_val:[],
                city_name:"",
                citys:[]
            };
        },
        template:`<transition enter-active-class="animated zoomIn" leave-active-class="animated zoomOut">
                    <div class="content">
                        <h1>First Demo</h1>
                        <input class="input_bar" type="text" @keyup="test_input" v-model="city_name">

                        <button class="btn btn-primary" @click="city_push">Input</button>
                        <ul id="city_list">
                            <!--<li v-for="item in citys" @click="delete_city">{{item}}</li>-->
                            <li v-for="item in citys" @click="delete_city">{{item.name}}</li>
                        </ul>
                        <button class="btn btn-success input_button" @click="show_au">AU</button>
                        <button class="btn btn-danger input_button2" @click="show_map">US</button>
                        <br>
                        <div id="city_content">{{city_name}}</div>
                        <div id="picture" style="width: 100%;height: 600px"></div>
                        <div id="picture_2" style="width: 100%;height: 600px"></div>
                        <!--<img src="https://www.excel-easy.com/smi/examples/line-chart.png" alt="">-->
                        <button @click="testb()">TEST</button>
                        <div>{{str}}</div>
                    </div>
                  </transition>`,
        methods:{
            test_input:function () {
                console.log(this.city_name);
            },
            testb:function () {
                this.$http.jsonp("https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su",{
                    params:{
                        wd:"a"
                    },
                    jsonp:"cb"
                }).then(function (value) {
                    //this.arr = value.body.s;
                    console.log(value);
                    this.str = value.body.s;
                    console.log(this.str);
                })
            },
            city_push:function () {
                this.citys.push(this.city_name);
                console.log(this.citys);
            },
            delete_city:function (e) {
                console.log(e.target.innerText);
                console.log(this.citys);
                let city_name = e.target.innerText.replace(/(^\s*)|(\s*$)/g, "");
                console.log(city_name == "Northam");
                for (let i in this.citys){
                    if (this.citys[i].name.replace(/(^\s*)|(\s*$)/g, "") == city_name){
                        console.log('44444');
                        this.citys.splice(i,1);
                    }
                }
            },
            delete_city_data:function (e) {
                for (let i in this.data_val){
                    if (this.data_val[i].name == e.target.innerText){
                        console.log('44444');
                        this.data_val.splice(i,1);
                    }
                }
            },
            show_map:function () {
                console.log(this.map_value);
                map_value = this.map_value;
                var map_color = this.map_color;
                var dom = document.getElementById("picture");
                $("#picture_2").hide();
                $("#picture").show();
                var myChart = echarts.init(dom);
                var app = {};
                option = null;
                myChart.showLoading();

                $.get('map/England.json', function (usaJson) {
                    console.log(usaJson)
                    console.log(this.map_value);
                    myChart.hideLoading();

                    echarts.registerMap('USA', usaJson, {
                        Alaska: {              // 把阿拉斯加移到美国主大陆左下方
                            left: -131,
                            top: 25,
                            width: 15
                        },
                        Hawaii: {
                            left: -110,        // 夏威夷
                            top: 28,
                            width: 5
                        },
                        'Puerto Rico': {       // 波多黎各
                            left: -76,
                            top: 26,
                            width: 2
                        }
                    });
                    option = {
                        title: {
                            text: 'USA Population Estimates (2012)',
                            subtext: 'Data from www.census.gov',
                            sublink: 'http://www.census.gov/popest/data/datasets.html',
                            left: 'right'
                        },
                        tooltip: {
                            trigger: 'item',
                            showDelay: 0,
                            transitionDuration: 0.2,
                            formatter: function (params) {
                                var value = (params.value + '').split('.');
                                value = value[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g, '$1,');
                                return params.seriesName + '<br/>' + params.name + ': ' + value;
                            }
                        },
                        visualMap: {
                            left: 'right',
                            min: 1,
                            max: 100,
                            inRange: {
                                 color:map_color
                            },
                            text:['High','Low'],           // 文本，默认为数值文本
                            calculable: true
                        },
                        toolbox: {
                            show: true,
                            //orient: 'vertical',
                            left: 'left',
                            top: 'top',
                            feature: {
                                dataView: {readOnly: false},
                                restore: {},
                                saveAsImage: {}
                            }
                        },
                        series: [
                            {
                                name: 'USA PopEstimates',
                                type: 'map',
                                roam: true,
                                map: 'USA',
                                itemStyle:{
                                    emphasis:{label:{show:true}}
                                },
                                // 文本位置修正
                                textFixed: {
                                    Alaska: [20, -20]
                                },
                                data:map_value,
                                // data:[
                                    // {name: 'Alabama', value: 50},
                                    // {name: 'Alaska', value: 731449},
                                    // {name: 'Arizona', value: 4}
                                    // {name: 'Arkansas', value: 2949131},
                                    // {name: 'California', value: 38041430},
                                    // {name: 'Colorado', value: 5187582},
                                    // {name: 'Connecticut', value: 3590347},
                                    // {name: 'Delaware', value: 917092},
                                    // {name: 'District of Columbia', value: 632323},
                                    // {name: 'Florida', value: 19317568},
                                    // {name: 'Georgia', value: 9919945},
                                    // {name: 'Hawaii', value: 1392313},
                                    // {name: 'Idaho', value: 1595728},
                                    // {name: 'Illinois', value: 12875255},
                                    // {name: 'Indiana', value: 6537334},
                                    // {name: 'Iowa', value: 3074186},
                                    // {name: 'Kansas', value: 2885905},
                                    // {name: 'Kentucky', value: 4380415},
                                    // {name: 'Louisiana', value: 4601893},
                                    // {name: 'Maine', value: 1329192},
                                    // {name: 'Maryland', value: 5884563},
                                    // {name: 'Massachusetts', value: 6646144},
                                    // {name: 'Michigan', value: 9883360},
                                    // {name: 'Minnesota', value: 5379139},
                                    // {name: 'Mississippi', value: 2984926},
                                    // {name: 'Missouri', value: 6021988},
                                    // {name: 'Montana', value: 1005141},
                                    // {name: 'Nebraska', value: 1855525},
                                    // {name: 'Nevada', value: 2758931},
                                    // {name: 'New Hampshire', value: 1320718},
                                    // {name: 'New Jersey', value: 8864590},
                                    // {name: 'New Mexico', value: 2085538},
                                    // {name: 'New York', value: 19570261},
                                    // {name: 'North Carolina', value: 9752073},
                                    // {name: 'North Dakota', value: 699628},
                                    // {name: 'Ohio', value: 11544225},
                                    // {name: 'Oklahoma', value: 3814820},
                                    // {name: 'Oregon', value: 3899353},
                                    // {name: 'Pennsylvania', value: 12763536},
                                    // {name: 'Rhode Island', value: 1050292},
                                    // {name: 'South Carolina', value: 4723723},
                                    // {name: 'South Dakota', value: 833354},
                                    // {name: 'Tennessee', value: 6456243},
                                    // {name: 'Texas', value: 26059203},
                                    // {name: 'Utah', value: 2855287},
                                    // {name: 'Vermont', value: 626011},
                                    // {name: 'Virginia', value: 8185867},
                                    // {name: 'Washington', value: 6897012},
                                    // {name: 'West Virginia', value: 1855413},
                                    // {name: 'Wisconsin', value: 5726398},
                                    // {name: 'Wyoming', value: 576412},
                                    // {name: 'Puerto Rico', value: 3667084}
                                // ]
                            }
                        ]
                    };

                    myChart.setOption(option);
                });
                // if (option && typeof option === "object") {
                //     myChart.setOption(option, true);
                // }on () {

            },
            show_au:function () {
                console.log(this.map_value);
                map_value = this.map_value;
                var map_color = this.map_color;
                var dom = document.getElementById("picture_2");
                $("#picture_2").show();
                $("#picture").hide();
                var myChart = echarts.init(dom);
                var app = {};
                option = null;
                myChart.showLoading();

                // var geo_val = this.locations;
                console.log(this.locations);
                var geo_val;
                // var data_val = this.data_val;
                var data_val = "222";
                console.log('-----');
                // console.log(geo_val);
                // console.log(data_val)
                console.log('------$$$$$$$-------');
                console.log(this.locations);
                // this.$http.get("http://localhost:5000/city_job_au",{emulateJSON:true}).then(function (value) {
                //     //this.arr = value.body.s;
                //
                //     console.log("111111");
                //     console.log(value.body.location);
                //     console.log(geo_val);
                //     var gee = Object(value.body.location);
                //     console.log(gee);
                //     // geo_val = Object(value.body.location);
                //     // data_val = value.body.data;
                //     // this.str = value.body.s;
                //     // console.log(this.str);
                // }).catch(function (reason) {
                //     console.log(reason);
                // });
                // if(this.)
                if (this.citys.length == 0) {
                    $.ajax({
                        url: "http://localhost:5000/city_job_au",
                        type: "get",
                        dataType: "json",
                        async: false,

                        success: function (result) {
                            // console.log(result.data);
                            console.log(result);
                            var rec_data = [];
                            console.log(result.location);
                            for (let i = 0; i < 2; i++) {
                                rec_data.push(Object(result.location[i]));
                                console.log(typeof result.location[i]);
                            }

                            console.log('------2222----');
                            console.log(rec_data);
                            // console.log(data_val);

                            data_val = result.data;
                            geo_val = result.location;
                            console.log(geo_val);
                            console.log('----------');
                            // console.log(data_val);
                            // console.log(result.location);
                            // console.log(geo_val);


                        }
                    });
                    this.locations = geo_val;
                    this.citys = data_val;
                }
                else{
                    data_val = this.citys;
                    geo_val = this.locations;
                }
                console.log('------$$$$$$$-------');

                console.log(data_val);


                $.get('map/Australia.json', function (geoJson) {

                    myChart.hideLoading();

                    echarts.registerMap('Australia', geoJson);
                    geoCoordMap = geo_val;
                    data = data_val;
                    var maxSize4Pin = 100,
                        minSize4Pin = 20;
                    var max = 10000,
                        min = 100; // todo
                    var convertData = function (data) {
                        var res = [];
                        console.log(data);
                        for (var i = 0; i < data.length; i++) {
                                var geoCoord = geoCoordMap[data[i].name];
                                if (geoCoord) {
                                    res.push({
                                        name: data[i].name,
                                        value: geoCoord.concat(data[i].value)
                                    });
                                }
                        }
                        return res;
                    };
                    console.log(convertData(data));
                    myChart.setOption(option = {
                        title: {
                            text: 'Australis Job distribution',
                            subtext: '',
                            sublink: 'http://zh.wikipedia.org/wiki/%E9%A6%99%E6%B8%AF%E8%A1%8C%E6%94%BF%E5%8D%80%E5%8A%83#cite_note-12'
                        },
                        tooltip: {
                            trigger: 'item',
                            formatter: function(params) {
                                if (typeof(params.value)[2] == "undefined") {
                                    return params.name + ' : ' + params.value;
                                } else {
                                    return params.name + ' : ' + params.value[2];
                                }
                            }
                        },

                        toolbox: {
                            show: true,
                            orient: 'vertical',
                            left: 'right',
                            top: 'center',
                            feature: {
                                dataView: {readOnly: false},
                                restore: {},
                                saveAsImage: {}
                            }
                        },
                        visualMap: {
                            min: 1,
                            max: 100,
                            type:"continuous",
                            text:['High','Low'],
                            realtime: false,
                            calculable: true,
                            inRange: {
                                color: ['lightskyblue','yellow', 'orangered']
                            }
                        },
                        geo: {
                            show: true,
                            map:"Australia",
                            mapType: 'Australia', // 自定义扩展图表类型
                            zoom:1.8,
                            label: {
                                normal: {
                                    show: false
                                },
                                emphasis: {
                                    show: false,
                                }
                            },
                            roam: true,
                            itemStyle: {
                                normal: {
                                    areaColor: '#bcb7b5',
                                    borderColor: '#3B5077',
                                },
                                emphasis: {
                                    areaColor: '#2B91B7',
                                }
                            }
                        },
                        series: [
                            // {
                            //     name: '香港18区人口密度',
                            //     type: 'map',
                            //     mapType: 'Australia', // 自定义扩展图表类型
                            //     roam: true,
                            //     itemStyle:{
                            //         normal:{label:{show:false}},
                            //         emphasis:{label:{show:true}}
                            //     },
                            //     data:[
                            //         {name: 'Western Australia', value: 20},
                            //         {name: 'Norfolk Island"', value: 15477.48},
                            //         // {name: 'Macquarie Island"', value: 31686.1},
                            //         // {name: '南区', value: 6992.6}
                            //         // {name: '油尖旺', value: 44045.49},
                            //         // {name: '深水埗', value: 40689.64},
                            //         // {name: '九龙城', value: 37659.78},
                            //         // {name: '黄大仙', value: 45180.97},
                            //         // {name: '观塘', value: 55204.26},
                            //         // {name: '葵青', value: 21900.9},
                            //         // {name: '荃湾', value: 4918.26},
                            //         // {name: '屯门', value: 5881.84},
                            //         // {name: '元朗', value: 4178.01},
                            //         // {name: '北区', value: 2227.92},
                            //         // {name: '大埔', value: 2180.98},
                            //         // {name: '沙田', value: 9172.94},
                            //         // {name: '西贡', value: 3368},
                            //         // {name: '离岛', value: 806.98}
                            //     ],
                            //     // 自定义名称映射
                            //     // nameMap: {
                            //     //     'Central and Western': '中西区',
                            //     //     'Eastern': '东区',
                            //     //     'Islands': '离岛',
                            //     //     'Kowloon City': '九龙城',
                            //     //     'Kwai Tsing': '葵青',
                            //     //     'Kwun Tong': '观塘',
                            //     //     'North': '北区'
                            //     //     // 'Sai Kung': '西贡',
                            //     //     // 'Sha Tin': '沙田',
                            //     //     // 'Sham Shui Po': '深水埗',
                            //     //     // 'Southern': '南区',
                            //     //     // 'Tai Po': '大埔',
                            //     //     // 'Tsuen Wan': '荃湾',
                            //     //     // 'Tuen Mun': '屯门',
                            //     //     // 'Wan Chai': '湾仔',
                            //     //     // 'Wong Tai Sin': '黄大仙',
                            //     //     // 'Yau Tsim Mong': '油尖旺',
                            //     //     // 'Yuen Long': '元朗'
                            //     // }
                            // },
                            {
                                name: 'credit_pm2.5',
                                type: 'scatter',
                                coordinateSystem: 'geo',
                                data: convertData(data),
                                symbolSize: function(val) {
                                    return val[2] / 10000;
                                },
                                label: {
                                    normal: {
                                        formatter: '{b}',
                                        position: 'right',
                                        show: true
                                    },
                                    emphasis: {
                                        show: true
                                    }
                                },
                                itemStyle: {
                                    normal: {
                                        color: '#05C3F9'
                                    }
                                }
                            },
                            {
                                type: 'map',
                                map: 'Australia',
                                geoIndex: 0,
                                zoom:3,
                                aspectScale: 0.75, //长宽比
                                showLegendSymbol: false, // 存在legend时显示
                                label: {
                                    normal: {
                                        show: false
                                    },
                                    emphasis: {
                                        show: false,
                                        textStyle: {
                                            color: '#fff'
                                        }
                                    }
                                },
                                roam: true,
                                itemStyle: {
                                    normal: {
                                        areaColor: '#031525',
                                        borderColor: '#3B5077',
                                    },
                                    emphasis: {
                                        areaColor: '#2B91B7'
                                    }
                                },
                                animation: false,
                                data: data
                            },
                            {
                                name: '点',
                                type: 'scatter',
                                coordinateSystem: 'geo',
                                symbol: 'pin',
                                symbolSize: function(val) {
                                    var a = (maxSize4Pin - minSize4Pin) / (max - min);
                                    var b = minSize4Pin - a * min;
                                    b = maxSize4Pin - a * max;
                                    return a * val[2] + b;
                                },
                                label: {
                                    normal: {
                                        show: true,
                                        formatter:function (val) {
                                            // console.log(val.value);
                                            return val.value[2];
                                        },
                                        textStyle: {
                                            color: '#fff',
                                            fontSize: 9,
                                        }
                                    }
                                },
                                itemStyle: {
                                    normal: {
                                        color: '#F62157', //标志颜色
                                    }
                                },
                                zlevel: 6,
                                data: convertData(data),
                            }
                        ]
                    });
                });
            }

        }

    };
    var demo2 = {
        template: `<transition enter-active-class="animated zoomIn" leave-active-class="animated zoomOut">
                    <div class="content">
                        <h1>Second Demo</h1>
                        <!--<img src="https://canvasjs.com/wp-content/uploads/images/gallery/javascript-charts/column/javascript-column-charts-graphs.png" alt="">-->
                        <button @click="show_can">SHOW</button>
                        <canvas id="can_demo2"></canvas>
                    </div>
                  </transition>`,
        methods: {
            show_can: function () {


                let myChart = document.getElementById('can_demo2');
                if (myChart) {
                    console.log('666');
                    console.log(myChart);
                    Chart.defaults.global.defaultFontFamily='lato';
                    Chart.defaults.global.defaultFontSize=10;

                    let massPopChart = new Chart(myChart.getContext('2d'), {
                        type: 'pie', //bar, horizontalBar, pie, line, doughnut, radar, polarArea
                        data: {
                            labels: ['Boston', 'Worcester', 'Springfield', 'Lowll', 'Cambridge', 'New Bedford'],
                            datasets: [{
                                label: 'Population',
                                data: [1814, 6175, 4256, 8453, 2123, 7560],
                                // backgroundColor:'green'
                                backgroundColor:[
                                    'rgba(255, 99, 132, 0.2)',
                                    'rgba(54, 162, 235, 0.2)',
                                    'rgba(255, 206, 86, 0.2)',
                                    'rgba(75, 192, 192, 0.2)',
                                    'rgba(153, 102, 255, 0.2)',
                                    'rgba(255, 159, 64, 0.2)'],
                                borderWidth:1,
                                borderColor:'#777',
                                hoverBorderWidth:3,
                                hoverBorderColor:'#000'
                            }],
                        },
                        options: {
                            title:{
                                display:true,
                                text: "Cities In Massach",
                                fontSize:25
                            },
                            legend:{
                                position:'right',
                                labels:{
                                    fontColor:'#000'
                                }
                            },
                            layout:{
                                padding:{
                                    left:50,
                                    right:0,
                                    bottom:0,
                                    top:0
                                }
                            },
                            tooltips:{
                                enabled:true
                            }
                        }
                    });
                }

            }
        }
    }
    var demo3 = {
        template:`<transition enter-active-class="animated zoomIn" leave-active-class="animated zoomOut">
                    <div class="content">
                        <h1>Third Demo</h1>
                        <img src="https://docs.microsoft.com/en-us/sql/reporting-services/report-builder/media/report-builder-quick-pie-chart.png?view=sql-server-2017" alt="">
                    </div>
                  </transition>`
    };

    var routes = [
        {"path":"/main",component:main},
        {"path":"/demo1",component:demo1},
        {"path":"/demo2",component:demo2},
        {"path":"/demo3",component:demo3}
    ];

    var router = new VueRouter({
        routes
    });

    new Vue({
        router,
        el:"#app",
        data:{
            title:"Comp 9021 demo",
            content:"Here is content",
            nav_bar:"Here is nva bar",
            mouse_X:200,
            mouse_Y:0,
            show_nav:false,
            menu_show:false,
            city_name:"",
            citys:[]
        },
        methods:{
            updateXY:function (e) {
                this.mouse_X = e.clientX;
                this.mouse_Y = e.offsetY;

            },
            menu_click:function () {
                console.log("66666");
                this.menu_show = true;
            },
            hide_menu:function () {
                this.menu_show = false;
            }


        }
    })

</script>
<script>

</script>
<script src="app.js"></script>
</body>
</html>